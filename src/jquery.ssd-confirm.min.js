/*
 * ssdConfirm jQuery plugin
 * Examples and documentation at: https://github.com/sebastiansulinski/ssd-confirm
 * Copyright (c) 2016 Sebastian Sulinski
 * Version: 0.0.1 (11-JUL-2016)
 * Licensed under the MIT.
 * Requires: jQuery v1.9 or later
 */
!function(t,a,r){"use strict";a.fn.ssdConfirm=function(e){var o=a.extend({dataType:"ssd-confirm-trigger",dataMessage:"ssd-confirm-message",dataUrl:"ssd-confirm-url",dataBehaviour:"ssd-confirm-behaviour",dataConfirmWrapper:"ssd-confirm",dataConfirmBlock:"ssd-confirm-block",dataConfirmContent:"ssd-confirm-content",dataButtonWrapper:"button-wrapper",dataButtonTrigger:"trigger",dataButtonProcessing:"processing",dataButtonYes:"ssd-confirm-yes",dataButtonNo:"ssd-confirm-no",dataRecordWrapper:"row",dataOverlay:"ssd-confirm-overlay",classActive:"active",classShow:"show",classHide:"hide",extendBlocks:{},extendBehaviours:{},actionProperties:function(t,a){return a}},e),n=a.extend({remove:function(t,r){d.showOverlay(),a("["+d.dataAttr(o.dataConfirmBlock)+'="remove"]').addClass(o.classShow).find("["+d.dataAttr(o.dataButtonYes)+"]").data("behaviour",r.behaviour).data("url",r.url).data("originator",t).addBack().find("["+d.dataAttr(o.dataConfirmContent)+"]").html(r.message),a("["+d.dataAttr(o.dataConfirmWrapper)+"]").addClass(o.classActive)}},o.extendBehaviours),s=a.extend({reload:function(a,r,e){t.location.reload(!0)},removeRow:function(t,r,e){d.hide(),e.originator.closest("["+d.dataAttr(o.dataRecordWrapper)+"]").fadeOut(200,function(){a(this).remove()})}},o.extendBehaviours),i={hasButtonSwap:function(t,a){return!d.isEmpty(t)&&!d.isEmpty(a)},showProcessing:function(t,a){this.hasButtonSwap(t,a)&&(t.addClass(o.classHide),a.removeClass(o.classHide))},hideProcessing:function(t,a){this.hasButtonSwap(t,a)&&(a.addClass(o.classHide),t.removeClass(o.classHide))},call:function(){a(document).on("click","["+d.dataAttr(o.dataButtonYes)+"]",function(t){d.prevent(t);var r=a(this),e=r.closest("["+d.dataAttr(o.dataButtonWrapper)+"]"),n={url:r.data("url"),behaviour:r.data("behaviour"),originator:r.data("originator"),processing:e.length>0?e.find("["+d.dataAttr(o.dataButtonProcessing)+"]"):null};n=o.actionProperties(r,n),i.showProcessing(r,n.processing),a.ajax({url:n.url,dataType:"json",success:function(t){s[n.behaviour](t,r,n)},error:function(t,a,e){throw i.hideProcessing(r,n.processing),new Error(e)}})})},init:function(){this.call()}},d={isEmpty:function(t){return"undefined"==typeof t||t===r||""===t||t===!1||null===t},prevent:function(t){t.preventDefault(),t.stopPropagation()},dataAttr:function(t){return"data-"+t},showOverlay:function(){a("["+d.dataAttr(o.dataOverlay)+"]").addClass(o.classShow)},hideOverlay:function(){a("["+d.dataAttr(o.dataOverlay)+"]").removeClass(o.classShow)},overlay:function(){a("["+d.dataAttr(o.dataOverlay)+"]").on("click",function(t){d.prevent(t),d.hide()})},hide:function(){a("[data-ssd-confirm]").removeClass(o.classActive).find("["+d.dataAttr(o.dataConfirmBlock)+"]").removeClass(o.classShow).find("["+d.dataAttr(o.dataButtonWrapper)+"] a, ["+d.dataAttr(o.dataButtonWrapper)+"] span").removeAttr("data-url").removeAttr("data-behaviour").removeAttr("data-originator").addBack().find("["+d.dataAttr(o.dataButtonProcessing)+"]").addClass(o.classHide).addBack().find("["+d.dataAttr(o.dataButtonTrigger)+"]").removeClass(o.classHide),this.hideOverlay()},buttonNo:function(){a("["+d.dataAttr(o.dataButtonNo)+"]").on("click",function(t){d.prevent(t),d.hide()})},hasMethod:function(t,a){return!d.isEmpty(t)&&a.hasOwnProperty(t)},trigger:function(t){t.each(function(){a(this).on("click",function(t){d.prevent(t);var r=a(this),e={type:r.data(o.dataType),url:r.data(o.dataUrl),message:r.data(o.dataMessage),behaviour:r.data(o.dataBehaviour)};d.hasMethod(e.type,n)&&n[e.type](r,e)})})},init:function(t){this.trigger(t),this.buttonNo(),this.overlay(),i.init()}};return d.init(this)}}(window,window.jQuery);